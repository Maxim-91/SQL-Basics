# Exercise: Basics of SQL

## Before You Start
Make sure you have the tables from the previous exercise before proceeding (MySQL-DB-and-tables).

---

## SECTION 1: SELECT + ORDER BY and LIMIT

- Write SQL statement to show the name and commission of all the salesmen.
- Find salesmen living in 'Paris'. Show name and city of each person.
- Show all columns from employees whose name includes 'James' or 'Adam'.
- Find the details of salesmen whose name starts with any letter within 'A' and 'L' (not inclusive). Show `salesman_id`, `name`, `city`, `commission` for each salesman. You can use `BETWEEN` comparison for the name field.
- Find those salesmen whose commission is greater than or equal to 0.13. Show name, commission for each salesman.
- Find the orders, which are delivered by a salesman with ID 5001. Show `ord_no`, `ord_date`, `purch_amt` for each order.
- Find the orders, which are delivered by a salesperson with ID 5001 and the purchase amount is more than 1000. Show `ord_no`, `ord_date`, `purch_amt` for each order.
- Find the products whose price is between 1000 and 4000. Show `ord_no`, `ord_date`, `purch_amt` for each product.
- Find all the orders with a purchase amount less than 500€ and completed before October 2012, or those with a purchase amount greater than 2000€ and completed in October 2012. Show `ord_no`, `purch_amt`, `ord_date` for each order. Show results in increasing order by `purch_amt`.
- Find the orders done in October 2012 and order the results by `customer_id`. Show all columns for each order.
- Find 5 most recent orders. Show all columns for each order.
- Find all customers. Order the results by `city` and `cust_name`.

---

## SECTION 2: AGGREGATES + GROUP BY

- Write SQL query to calculate the average purchase amount of all orders.
- Write SQL query to calculate the total purchase amount of all orders.
- Write SQL query to count the number of orders.
- Write SQL query to count the number of salesmen.
- Write SQL query to count the number of orders after 2012-07-01.
- Write SQL query to find the maximum purchase amount.
- Write SQL query to find the lowest purchase amount ordered by each customer. Show `customer_id` and minimum purchase amount for each customer. Order the results by `customer_id`.
- Write SQL query to find the highest purchase amount ordered on a particular date. Show `order_date` and the highest purchase amount.
- Write SQL query to find the highest purchase amount by each customer. Show only those results where the highest amount is more than 2000€. Show `customer_id` and maximum purchase amount.
- Write SQL query to find the maximum purchase amount by each salesman whose ID is between 5003 and 5008 (inclusive). Return `salesperson_id` and maximum purchase amount for each row.
- Write SQL query to count how many orders have been made on 2012-08-17. Return the number of orders.
- Show how many orders have been made each date.
- Write SQL query to calculate the average purchase amount of each salesman. Show `salesman_id` and average purchase amount. Order the results in decreasing order by average purchase amount.
- Write SQL query to find the `purch_amt` which is greater than the average order value of 10th October 2012. Return `ord_no`, `purch_amt`, `ord_date`, `customer_id`, `salesman_id`.

---

## SECTION 3: JOINS and UNIONS, VIEWS

- Write SQL query to find all the orders. Instead of showing `customer_id`, show the customer’s name. Show `ord_no`, `purch_amt`, `ord_date`, `customer_name` for each order. You need to join `orders` and `customer` tables.
- Write SQL query to find all the orders. Instead of showing `salesman_id`, show the salesman’s name and instead of showing `customer_id`, show the customer’s name. Return `ord_no`, `purch_amt`, `ord_date`, `customer_name`, and `salesman_name`. You need to join `orders`, `salesman`, and `customers` tables.
- Find the salesperson and customer who belong to the same city. Return `salesman`, `cust_name`, and `city`. Order the results by `city`.
- Calculate the average purchase amount of each customer. Return `customer_name` and average purchase. Return also rows for customers who have not purchased anything (e.g., Marion Cameron). Hint: You need information from two tables.
- Write SQL query to find all customers and their salesman. Show `customer_name` and `salesman_name`. You need information from `salesman` and `customer` tables.
- Find all customers who are not living in the same city as their salesman. Show `cust_name` and their city + `salesman’s` name and their city.
- Find all the orders issued by the salesman 'Paul Adam’. Show `ord_no`, `purch_amt`, `ord_date`, and salesman’s name.
- Write SQL query to find all the orders, which are generated by those salesmen who live in the city of London. Show `ord_no`, salesman’s name, and city.
- Write a SQL query to find the commission of the salesmen whose customer is in Paris. Return `salesman_id`, `salesman_name`, and commission.
- Create a view for those salesmen living in the city 'Paris’. Show `salesman_id`, `name`, and `city`.
- Create a view for showing all customers with the following information: `customer_id`, `cust_name`, and `salesman_name`.
- Create a view to compute average purchase amount and total purchase amount for each salesperson. Return `name`, average purchase, and total purchase amount. (Assume all names are unique).

---

## SECTION 4: UPDATES, DELETES

- Update salesman whose ID is 5007. Change name to 'Paul White' and city to 'London'.
- Update customer whose ID is 3005. Change grade to 300.
- Change salesman whose ID is 5007 to ID 5009. You should notice the contradiction if you try to modify the ID because it is referenced as a foreign key from the customer and orders table. There are two options to do the task:
  - Option 1: Drop the foreign key constraint from customer and order table first, then make the change and create the foreign key constraints again.
  - Option 2: Insert “new” correct information to salesman. Then update the information in the other two tables and finally remove the outdated information.
- Delete order number 70014 from orders.
- Delete salesman whose ID is 5010 and all the customers who have the reference to this salesman. Hint: You have to delete first the customers who have the reference to `salesman_id` 5010.
